var oe=Object.defineProperty,le=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var X=($,i,t)=>i in $?oe($,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):$[i]=t,q=($,i)=>{for(var t in i||(i={}))ce.call(i,t)&&X($,t,i[t]);if(G)for(var t of G(i))ie.call(i,t)&&X($,t,i[t]);return $},Q=($,i)=>le($,re(i));import{o as n,e as v,h as l,z as O,B as J,A as F,U as L,Q as de,k as I,r as u,f as s,w as o,u as e,t as B,l as _,F as K,y as W,j as h,m as Z,i as V,ab as ee,R as ue,x as me,aF as _e}from"./vendor.c29fa1eb.js";import{g as te,j as M,b as pe,i as fe,e as he,f as S}from"./main.02f9c92c.js";import{_ as ye}from"./LineChart.54af62cf.js";import{_ as ge}from"./CustomerIndexDropdown.e3a1e11a.js";const xe={},be={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ve=l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Be=l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),$e=[ve,Be];function we($,i){return n(),v("svg",be,$e)}var Ce=te(xe,[["render",we]]);const ke={class:"fixed top-0 left-0 hidden h-full pt-16 pb-[6.6rem] ml-56 bg-white xl:ml-64 w-88 xl:block"},Te={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},Ee={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},Ie={class:"px-4 py-3 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},De={class:"px-2"},Ae={class:"px-2"},Se={class:"flex-1 font-bold text-right whitespace-nowrap"},Ve={key:0,class:"flex justify-center p-4 items-center"},je={key:1,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},Fe={setup($){const i=M(),t=O(),{t:m}=J();let r=F(!1),a=L({orderBy:null,orderByField:null,searchText:null});const p=F(null),g=F(1),x=F(1),D=F(null);d=de.exports.debounce(d,500);const y=I(()=>a.orderBy==="asc"||a.orderBy==null);I(()=>y.value?m("general.ascending"):m("general.descending"));function w(c){return t.params.id==c}async function b(c,k=!1){if(r.value)return;let T={};a.searchText!==""&&a.searchText!==null&&a.searchText!==void 0&&(T.display_name=a.searchText),a.orderBy!==null&&a.orderBy!==void 0&&(T.orderBy=a.orderBy),a.orderByField!==null&&a.orderByField!==void 0&&(T.orderByField=a.orderByField),r.value=!0;let P=await i.fetchCustomers(Q(q({page:c},T),{limit:15}));r.value=!1,p.value=p.value?p.value:[],p.value=[...p.value,...P.data.data],g.value=c||1,x.value=P.data.meta.last_page;let j=p.value.find(R=>R.id==t.params.id);k==!1&&!j&&g.value<x.value&&Object.keys(T).length===0&&b(++g.value),j&&setTimeout(()=>{k==!1&&C()},500)}function C(){const c=document.getElementById(`customer-${t.params.id}`);c&&(c.scrollIntoView({behavior:"smooth"}),c.classList.add("shake"),A())}function A(){D.value.addEventListener("scroll",c=>{c.target.scrollTop>0&&c.target.scrollTop+c.target.clientHeight>c.target.scrollHeight-200&&g.value<x.value&&b(++g.value,!0)})}async function d(){p.value=[],b()}function E(){return a.orderBy==="asc"?(a.orderBy="desc",d(),!0):(a.orderBy="asc",d(),!0)}return b(),(c,k)=>{var Y;const T=u("BaseIcon"),P=u("BaseInput"),j=u("BaseButton"),R=u("BaseRadio"),U=u("BaseInputGroup"),z=u("BaseDropdownItem"),se=u("BaseDropdown"),H=u("BaseText"),ae=u("BaseFormatMoney"),ne=u("router-link");return n(),v("div",ke,[l("div",Te,[s(P,{modelValue:e(a).searchText,"onUpdate:modelValue":k[0]||(k[0]=f=>e(a).searchText=f),placeholder:c.$t("general.search"),"container-class":"mb-6",type:"text",variant:"gray",onInput:k[1]||(k[1]=f=>d())},{default:o(()=>[s(T,{name:"SearchIcon",class:"text-gray-500"})]),_:1},8,["modelValue","placeholder"]),l("div",Ee,[s(se,{"close-on-select":!1,position:"bottom-start","width-class":"w-40","position-class":"left-0"},{activator:o(()=>[s(j,{variant:"gray"},{default:o(()=>[s(T,{name:"FilterIcon"})]),_:1})]),default:o(()=>[l("div",Ie,B(c.$t("general.sort_by")),1),l("div",De,[s(z,{class:"flex px-1 py-2 mt-1 cursor-pointer hover:rounded-md"},{default:o(()=>[s(U,{class:"pt-2 -mt-4"},{default:o(()=>[s(R,{id:"filter_create_date",modelValue:e(a).orderByField,"onUpdate:modelValue":[k[2]||(k[2]=f=>e(a).orderByField=f),d],label:c.$t("customers.create_date"),size:"sm",name:"filter",value:"invoices.created_at"},null,8,["modelValue","label"])]),_:1})]),_:1})]),l("div",Ae,[s(z,{class:"flex px-1 cursor-pointer hover:rounded-md"},{default:o(()=>[s(U,{class:"pt-2 -mt-4"},{default:o(()=>[s(R,{id:"filter_display_name",modelValue:e(a).orderByField,"onUpdate:modelValue":[k[3]||(k[3]=f=>e(a).orderByField=f),d],label:c.$t("customers.display_name"),size:"sm",name:"filter",value:"name"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),s(j,{class:"ml-1",size:"md",variant:"gray",onClick:E},{default:o(()=>[e(y)?(n(),_(T,{key:0,name:"SortAscendingIcon"})):(n(),_(T,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),l("div",{ref:(f,N)=>{N.customerListSection=f,D.value=f},class:"h-full overflow-y-scroll border-l border-gray-200 border-solid sidebar base-scroll"},[(n(!0),v(K,null,W(p.value,(f,N)=>(n(),v("div",{key:N},[f?(n(),_(ne,{key:0,id:"customer-"+f.id,to:`/admin/customers/${f.id}/view`,class:Z(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":w(f.id)}]),style:{"border-top":"1px solid rgba(185, 193, 209, 0.41)"}},{default:o(()=>[l("div",null,[s(H,{text:f.name,length:30,class:"pr-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),f.contact_name?(n(),_(H,{key:0,text:f.contact_name,length:30,class:"mt-1 text-xs not-italic font-medium leading-5 text-gray-600"},null,8,["text"])):h("",!0)]),l("div",Se,[s(ae,{amount:f.due_amount!==null?f.due_amount:0,currency:f.currency},null,8,["amount","currency"])])]),_:2},1032,["id","to","class"])):h("",!0)]))),128)),e(r)?(n(),v("div",Ve,[s(Ce,{class:"h-6 m-1 animate-spin text-primary-400"})])):h("",!0),!((Y=p.value)==null?void 0:Y.length)&&!e(r)?(n(),v("p",je,B(c.$t("customers.no_matching_customers")),1)):h("",!0)],512)])}}},Pe={class:"pt-6 mt-5 border-t border-solid lg:pt-8 md:pt-4 border-gray-200"},Re={key:0,class:"text-sm font-bold leading-5 text-black non-italic"},Le={key:0},Me={key:1},Ne={key:1,class:"text-sm font-bold leading-5 text-black non-italic"},Oe={setup($){const i=M(),t=I(()=>i.selectedViewCustomer),m=I(()=>i.isFetchingViewData),r=I(()=>{var a,p;return((a=t==null?void 0:t.value)==null?void 0:a.fields)?(p=t==null?void 0:t.value)==null?void 0:p.fields:[]});return(a,p)=>{const g=u("BaseHeading"),x=u("BaseDescriptionListItem"),D=u("BaseDescriptionList"),y=u("BaseCustomerAddressDisplay");return n(),v("div",Pe,[s(g,null,{default:o(()=>[V(B(a.$t("customers.basic_info")),1)]),_:1}),s(D,null,{default:o(()=>{var w,b,C;return[s(x,{"content-loading":e(m),label:a.$t("customers.display_name"),value:(w=e(t))==null?void 0:w.name},null,8,["content-loading","label","value"]),s(x,{"content-loading":e(m),label:a.$t("customers.primary_contact_name"),value:(b=e(t))==null?void 0:b.contact_name},null,8,["content-loading","label","value"]),s(x,{"content-loading":e(m),label:a.$t("customers.email"),value:(C=e(t))==null?void 0:C.email},null,8,["content-loading","label","value"])]}),_:1}),s(D,{class:"mt-5"},{default:o(()=>{var w,b,C,A,d,E,c;return[s(x,{"content-loading":e(m),label:a.$t("wizard.currency"),value:((w=e(t))==null?void 0:w.currency)?`${(C=(b=e(t))==null?void 0:b.currency)==null?void 0:C.code} (${(d=(A=e(t))==null?void 0:A.currency)==null?void 0:d.symbol})`:""},null,8,["content-loading","label","value"]),s(x,{"content-loading":e(m),label:a.$t("customers.phone_number"),value:(E=e(t))==null?void 0:E.phone},null,8,["content-loading","label","value"]),s(x,{"content-loading":e(m),label:a.$t("customers.website"),value:(c=e(t))==null?void 0:c.website},null,8,["content-loading","label","value"])]}),_:1}),e(t).billing||e(t).shipping?(n(),_(g,{key:0,class:"mt-8"},{default:o(()=>[V(B(a.$t("customers.address")),1)]),_:1})):h("",!0),s(D,{class:"mt-5"},{default:o(()=>[e(t).billing?(n(),_(x,{key:0,"content-loading":e(m),label:a.$t("customers.billing_address")},{default:o(()=>[s(y,{address:e(t).billing},null,8,["address"])]),_:1},8,["content-loading","label"])):h("",!0),e(t).shipping?(n(),_(x,{key:1,"content-loading":e(m),label:a.$t("customers.shipping_address")},{default:o(()=>[s(y,{address:e(t).shipping},null,8,["address"])]),_:1},8,["content-loading","label"])):h("",!0)]),_:1}),e(r).length>0?(n(),_(g,{key:1,class:"mt-8"},{default:o(()=>[V(B(a.$t("settings.custom_fields.title")),1)]),_:1})):h("",!0),s(D,{class:"mt-5"},{default:o(()=>[(n(!0),v(K,null,W(e(r),(w,b)=>(n(),_(x,{key:b,"content-loading":e(m),label:w.custom_field.label},{default:o(()=>[w.type==="Switch"?(n(),v("p",Re,[w.default_answer===1?(n(),v("span",Le," Yes ")):(n(),v("span",Me," No "))])):(n(),v("p",Ne,B(w.default_answer),1))]),_:2},1032,["content-loading","label"]))),128))]),_:1})])}}},Ue={},ze={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},He={class:"flex justify-between mt-1 mb-6"},Ye={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},Ge={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Xe={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},qe={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"},Qe={class:"flex flex-col items-center justify-center px-6 py-2 lg:justify-end lg:items-end"};function Je($,i){const t=u("BaseContentPlaceholdersText"),m=u("BaseContentPlaceholdersBox"),r=u("BaseContentPlaceholders");return n(),_(r,{class:"grid grid-cols-12"},{default:o(()=>[l("div",ze,[l("div",He,[s(t,{class:"h-10 w-36",lines:1}),s(t,{class:"h-10 w-40 !mt-0",lines:1})]),s(m,{class:"h-80 xl:h-72 sm:w-full"})]),l("div",Ye,[l("div",Ge,[s(t,{class:"h-3 w-14 xl:h-4",lines:1}),s(t,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",Xe,[s(t,{class:"h-3 w-14 xl:h-4",lines:1}),s(t,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",qe,[s(t,{class:"h-3 w-14 xl:h-4",lines:1}),s(t,{class:"w-20 h-5 xl:h-6",lines:1})]),l("div",Qe,[s(t,{class:"h-3 w-14 xl:h-4",lines:1}),s(t,{class:"w-20 h-5 xl:h-6",lines:1})])])]),_:1})}var Ke=te(Ue,[["render",Je]]);const We={key:1,class:"grid grid-cols-12"},Ze={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},et={class:"flex justify-between mt-1 mb-6"},tt={class:"flex items-center"},st={class:"w-40 h-10"},at={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},nt={class:"px-6 py-2"},ot={class:"text-xs leading-5 lg:text-sm"},lt=l("br",null,null,-1),rt={key:0,class:"block mt-1 text-xl font-semibold leading-8"},ct={class:"px-6 py-2"},it={class:"text-xs leading-5 lg:text-sm"},dt=l("br",null,null,-1),ut={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#00c99c"}},mt={class:"px-6 py-2"},_t={class:"text-xs leading-5 lg:text-sm"},pt=l("br",null,null,-1),ft={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#fb7178"}},ht={class:"px-6 py-2"},yt={class:"text-xs leading-5 lg:text-sm"},gt=l("br",null,null,-1),xt={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#5851d8"}},bt={setup($){pe();const i=M();ee("utils");const t=O();let m=F(!1),r=L({}),a=L({}),p=L(["This year","Previous year"]),g=F("This year");const x=I(()=>r.expenseTotals?r.expenseTotals:[]),D=I(()=>r.netProfits?r.netProfits:[]),y=I(()=>r&&r.months?r.months:[]),w=I(()=>r.receiptTotals?r.receiptTotals:[]),b=I(()=>r.invoiceTotals?r.invoiceTotals:[]);ue(t,()=>{t.params.id&&C(),g.value="This year"},{immediate:!0});async function C(){m.value=!1;let d=await i.fetchViewCustomer({id:t.params.id});d.data&&(Object.assign(r,d.data.meta.chartData),Object.assign(a,d.data.data)),m.value=!0}async function A(d){let E={id:t.params.id};d==="Previous year"?E.previous_year=!0:E.this_year=!0;let c=await i.fetchViewCustomer(E);return c.data.meta.chartData&&Object.assign(r,c.data.meta.chartData),!0}return(d,E)=>{const c=u("BaseIcon"),k=u("BaseMultiselect"),T=u("BaseFormatMoney"),P=u("BaseCard");return n(),_(P,{class:"flex flex-col mt-6"},{default:o(()=>[e(i).isFetchingViewData?(n(),_(Ke,{key:0})):(n(),v("div",We,[l("div",Ze,[l("div",et,[l("h6",tt,[s(c,{name:"ChartSquareBarIcon",class:"h-5 text-primary-400"}),V(" "+B(d.$t("dashboard.monthly_chart.title")),1)]),l("div",st,[s(k,{modelValue:e(g),"onUpdate:modelValue":E[0]||(E[0]=j=>me(g)?g.value=j:g=j),options:e(p),"allow-empty":!1,"show-labels":!1,placeholder:d.$t("dashboard.select_year"),"can-deselect":!1,onSelect:A},null,8,["modelValue","options","placeholder"])])]),e(m)?(n(),_(ye,{key:0,invoices:e(b),expenses:e(x),receipts:e(w),income:e(D),labels:e(y),class:"sm:w-full"},null,8,["invoices","expenses","receipts","income","labels"])):h("",!0)]),l("div",at,[l("div",nt,[l("span",ot,B(d.$t("dashboard.chart_info.total_sales")),1),lt,e(m)?(n(),v("span",rt,[s(T,{amount:e(r).salesTotal,currency:e(a).currency},null,8,["amount","currency"])])):h("",!0)]),l("div",ct,[l("span",it,B(d.$t("dashboard.chart_info.total_receipts")),1),dt,e(m)?(n(),v("span",ut,[s(T,{amount:e(r).totalExpenses,currency:e(a).currency},null,8,["amount","currency"])])):h("",!0)]),l("div",mt,[l("span",_t,B(d.$t("dashboard.chart_info.total_expense")),1),pt,e(m)?(n(),v("span",ft,[s(T,{amount:e(r).totalExpenses,currency:e(a).currency},null,8,["amount","currency"])])):h("",!0)]),l("div",ht,[l("span",yt,B(d.$t("dashboard.chart_info.net_income")),1),gt,e(m)?(n(),v("span",xt,[s(T,{amount:e(r).netProfit,currency:e(a).currency},null,8,["amount","currency"])])):h("",!0)])])])),s(Oe)]),_:1})}}},kt={setup($){ee("utils"),fe();const i=M(),t=he();J();const m=_e(),r=O();F(null);const a=I(()=>i.selectedViewCustomer.customer?i.selectedViewCustomer.customer.name:"");let p=I(()=>i.isFetchingViewData);function g(){return t.hasAbilities([S.CREATE_ESTIMATE,S.CREATE_INVOICE,S.CREATE_PAYMENT,S.CREATE_EXPENSE])}function x(){return t.hasAbilities([S.DELETE_CUSTOMER,S.EDIT_CUSTOMER])}function D(){m.push("/admin/customers")}return(y,w)=>{const b=u("BaseButton"),C=u("router-link"),A=u("BaseIcon"),d=u("BaseDropdownItem"),E=u("BaseDropdown"),c=u("BasePageHeader"),k=u("BasePage");return n(),_(k,{class:"xl:pl-96"},{default:o(()=>[s(c,{title:e(a)},{actions:o(()=>[e(t).hasAbilities(e(S).EDIT_CUSTOMER)?(n(),_(C,{key:0,to:`/admin/customers/${e(r).params.id}/edit`},{default:o(()=>[s(b,{class:"mr-3",variant:"primary-outline","content-loading":e(p)},{default:o(()=>[V(B(y.$t("general.edit")),1)]),_:1},8,["content-loading"])]),_:1},8,["to"])):h("",!0),g()?(n(),_(E,{key:1,position:"bottom-end","content-loading":e(p)},{activator:o(()=>[s(b,{class:"mr-3",variant:"primary","content-loading":e(p)},{default:o(()=>[V(B(y.$t("customers.new_transaction")),1)]),_:1},8,["content-loading"])]),default:o(()=>[e(t).hasAbilities(e(S).CREATE_ESTIMATE)?(n(),_(C,{key:0,to:`/admin/estimates/create?customer=${y.$route.params.id}`},{default:o(()=>[s(d,{class:""},{default:o(()=>[s(A,{name:"DocumentIcon",class:"mr-3 text-gray-600"}),V(" "+B(y.$t("estimates.new_estimate")),1)]),_:1})]),_:1},8,["to"])):h("",!0),e(t).hasAbilities(e(S).CREATE_INVOICE)?(n(),_(C,{key:1,to:`/admin/invoices/create?customer=${y.$route.params.id}`},{default:o(()=>[s(d,null,{default:o(()=>[s(A,{name:"DocumentTextIcon",class:"mr-3 text-gray-600"}),V(" "+B(y.$t("invoices.new_invoice")),1)]),_:1})]),_:1},8,["to"])):h("",!0),e(t).hasAbilities(e(S).CREATE_PAYMENT)?(n(),_(C,{key:2,to:`/admin/payments/create?customer=${y.$route.params.id}`},{default:o(()=>[s(d,null,{default:o(()=>[s(A,{name:"CreditCardIcon",class:"mr-3 text-gray-600"}),V(" "+B(y.$t("payments.new_payment")),1)]),_:1})]),_:1},8,["to"])):h("",!0),e(t).hasAbilities(e(S).CREATE_EXPENSE)?(n(),_(C,{key:3,to:`/admin/expenses/create?customer=${y.$route.params.id}`},{default:o(()=>[s(d,null,{default:o(()=>[s(A,{name:"CalculatorIcon",class:"mr-3 text-gray-600"}),V(" "+B(y.$t("expenses.new_expense")),1)]),_:1})]),_:1},8,["to"])):h("",!0)]),_:1},8,["content-loading"])):h("",!0),x()?(n(),_(ge,{key:2,class:Z({"ml-3":e(p)}),row:e(i).selectedViewCustomer,"load-data":D},null,8,["class","row"])):h("",!0)]),_:1},8,["title"]),s(Fe),s(bt)]),_:1})}}};export{kt as default};
