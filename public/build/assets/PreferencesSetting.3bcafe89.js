var E=Object.defineProperty;var B=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var V=(m,l,a)=>l in m?E(m,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):m[l]=a,$=(m,l)=>{for(var a in l||(l={}))M.call(l,a)&&V(m,a,l[a]);if(B)for(var a of B(l))F.call(l,a)&&V(m,a,l[a]);return m};import{B as N,A as S,U,k as g,R as Y,D as v,E as y,M as G,r as p,o as O,e as j,f as s,w as c,u as e,m as P,i as T,t as Z,N as A}from"./vendor.c29fa1eb.js";import{b as R,d as H}from"./main.02f9c92c.js";const J=["onSubmit"],X={setup(m){const l=R(),a=H(),{t:_,tm:K}=N();let b=S(!1);S(!1);let r=S(!1);const n=U($({},l.selectedCompanySettings));g(()=>a.config.retrospective_edits.map(t=>(t.title=_(t.key),t))),Y(()=>n.carbon_date_format,t=>{if(t){const o=a.dateFormats.find(d=>d.carbon_format_value===t);n.moment_date_format=o.moment_format_value}}),g({get:()=>n.discount_per_item==="YES",set:async t=>{const o=t?"YES":"NO";let d={settings:{discount_per_item:o}};n.discount_per_item=o,await l.updateCompanySettings({data:d,message:"general.setting_updated"})}}),g({get:()=>n.has_transport_option==="YES",set:async t=>{const o=t?"YES":"NO";let d={settings:{has_transport_option:o}};n.has_transport_option=o,await l.updateCompanySettings({data:d,message:"general.setting_updated"})}}),g({get:()=>n.automatically_expire_public_links==="YES",set:async t=>{const o=t?"YES":"NO";n.automatically_expire_public_links=o}});const k=g(()=>({language:{required:v.withMessage(_("validation.required"),y)},carbon_date_format:{required:v.withMessage(_("validation.required"),y)},moment_date_format:{required:v.withMessage(_("validation.required"),y)},time_zone:{required:v.withMessage(_("validation.required"),y)}})),i=G(k,g(()=>n));q();async function q(){r.value=!0,Promise.all([a.fetchDateFormats(),a.fetchTimeZones()]).then(([t])=>{r.value=!1})}async function w(){if(i.value.$touch(),i.value.$invalid)return;let t={settings:$({},n)};b.value=!0,delete t.settings.link_expiry_days,await l.updateCompanySettings({data:t,message:"settings.preferences.updated_message"}),b.value=!1}return(t,o)=>{const d=p("BaseMultiselect"),f=p("BaseInputGroup"),C=p("BaseInputGrid"),h=p("BaseDivider"),I=p("BaseIcon"),D=p("BaseButton"),z=p("BaseSettingCard");return O(),j("form",{action:"",class:"relative",onSubmit:A(w,["prevent"])},[s(z,{title:t.$t("settings.menu_title.preferences"),description:t.$t("settings.preferences.general_settings")},{default:c(()=>[s(C,{class:"mt-5"},{default:c(()=>[s(f,{label:t.$tc("settings.preferences.default_language"),"content-loading":e(r),error:e(i).language.$error&&e(i).language.$errors[0].$message,required:""},{default:c(()=>[s(d,{modelValue:e(n).language,"onUpdate:modelValue":o[0]||(o[0]=u=>e(n).language=u),"content-loading":e(r),options:e(a).config.languages,label:"name","value-prop":"code",class:"w-full","track-by":"name",searchable:!0,invalid:e(i).language.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(f,{label:t.$tc("settings.preferences.time_zone"),"content-loading":e(r),error:e(i).time_zone.$error&&e(i).time_zone.$errors[0].$message,required:""},{default:c(()=>[s(d,{modelValue:e(n).time_zone,"onUpdate:modelValue":o[1]||(o[1]=u=>e(n).time_zone=u),"content-loading":e(r),options:e(a).timeZones,label:"key",class:"w-full","value-prop":"value","track-by":"key",searchable:!0,invalid:e(i).time_zone.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(f,{label:t.$tc("settings.preferences.date_format"),"content-loading":e(r),error:e(i).carbon_date_format.$error&&e(i).carbon_date_format.$errors[0].$message,required:""},{default:c(()=>[s(d,{modelValue:e(n).carbon_date_format,"onUpdate:modelValue":o[2]||(o[2]=u=>e(n).carbon_date_format=u),"content-loading":e(r),options:e(a).dateFormats,label:"display_date","value-prop":"carbon_format_value","track-by":"display_date",searchable:"",invalid:e(i).carbon_date_format.$error,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"])]),_:1}),s(h,{class:"mt-6 mb-2"}),s(f,{label:t.$tc("settings.preferences.attendance_system"),"content-loading":e(r),required:""},{default:c(()=>[s(d,{modelValue:e(n).attendance_system,"onUpdate:modelValue":o[3]||(o[3]=u=>e(n).attendance_system=u),"content-loading":e(r),options:e(a).config.attendance_system,label:"name","value-prop":"name","track-by":"name",searchable:!0},null,8,["modelValue","content-loading","options"])]),_:1},8,["label","content-loading"]),s(h,{class:"mt-6 mb-2"}),s(f,{label:t.$tc("settings.preferences.health_care_system"),"content-loading":e(r),required:""},{default:c(()=>[s(d,{modelValue:e(n).health_care_system,"onUpdate:modelValue":o[4]||(o[4]=u=>e(n).health_care_system=u),"content-loading":e(r),options:e(a).config.health_care_system,openDirection:"top",label:"name","value-prop":"name","track-by":"name",searchable:!0},null,8,["modelValue","content-loading","options"])]),_:1},8,["label","content-loading"]),s(D,{"content-loading":e(r),disabled:e(b),loading:e(b),type:"submit",class:"mt-6"},{left:c(u=>[s(I,{name:"SaveIcon",class:P(u.class)},null,8,["class"])]),default:c(()=>[T(" "+Z(t.$tc("settings.clinic.save")),1)]),_:1},8,["content-loading","disabled","loading"])]),_:1},8,["title","description"])],40,J)}}};export{X as default};
