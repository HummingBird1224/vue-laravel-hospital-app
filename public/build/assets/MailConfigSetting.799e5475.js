import{a as L,d as ne,B as j,A as G,U as H,k as V,D as v,E as _,aM as K,J as N,M as x,S as J,r as p,o as M,e as O,f as l,w as m,u as e,l as w,x as E,h as F,m as A,j as T,i as S,t as k,g as R,N as z,L as Q,ad as ae,F as te}from"./vendor.c29fa1eb.js";import{h as X,u as W,c as Y}from"./main.02f9c92c.js";const P=(t=!1)=>{const b=t?window.pinia.defineStore:ne,{global:f}=window.i18n;return b({id:"mail-driver",state:()=>({mailConfigData:null,mail_driver:"smtp",mail_drivers:[],basicMailConfig:{mail_driver:"",mail_host:"",from_mail:"",from_name:""},mailgunConfig:{mail_driver:"",mail_mailgun_domain:"",mail_mailgun_secret:"",mail_mailgun_endpoint:"",from_mail:"",from_name:""},sesConfig:{mail_driver:"",mail_host:"",mail_port:null,mail_ses_key:"",mail_ses_secret:"",mail_encryption:"tls",from_mail:"",from_name:""},smtpConfig:{mail_driver:"",mail_host:"",mail_port:null,mail_username:"",mail_password:"",mail_encryption:"tls",from_mail:"",from_name:""}}),actions:{fetchMailDrivers(){return new Promise((i,u)=>{L.get("/api/v1/mail/drivers").then(r=>{r.data&&(this.mail_drivers=r.data),i(r)}).catch(r=>{X(r),u(r)})})},fetchMailConfig(){return new Promise((i,u)=>{L.get("/api/v1/mail/config").then(r=>{r.data&&(this.mailConfigData=r.data,this.mail_driver=r.data.mail_driver),i(r)}).catch(r=>{X(r),u(r)})})},updateMailConfig(i){return new Promise((u,r)=>{L.post("/api/v1/mail/config",i).then(g=>{const q=W();g.data.success?q.showNotification({type:"success",message:f.t("wizard.success."+g.data.success)}):q.showNotification({type:"error",message:f.t("wizard.errors."+g.data.error)}),u(g)}).catch(g=>{X(g),r(g)})})},sendTestMail(i){return new Promise((u,r)=>{L.post("/api/v1/mail/test",i).then(g=>{const q=W();g.data.success?q.showNotification({type:"success",message:f.t("general.send_mail_successfully")}):q.showNotification({type:"error",message:f.t("validation.something_went_wrong")}),u(g)}).catch(g=>{X(g),r(g)})})}}})()},oe=["onSubmit"],le={class:"flex my-10"},Z={props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1},mailDrivers:{type:Array,require:!0,default:Array}},emits:["submit-data","on-change-driver"],setup(t,{emit:b}){const f=t,i=P(),{t:u}=j();let r=G(!1);const g=H(["tls","ssl","starttls"]),q=V(()=>r.value?"text":"password"),a=V(()=>({smtpConfig:{mail_driver:{required:v.withMessage(u("validation.required"),_)},mail_host:{required:v.withMessage(u("validation.required"),_)},mail_port:{required:v.withMessage(u("validation.required"),_),numeric:v.withMessage(u("validation.numbers_only"),K)},mail_encryption:{required:v.withMessage(u("validation.required"),_)},from_mail:{required:v.withMessage(u("validation.required"),_),email:v.withMessage(u("validation.email_incorrect"),N)},from_name:{required:v.withMessage(u("validation.required"),_)}}})),d=x(a,V(()=>i));J(()=>{for(const o in i.smtpConfig)f.configData.hasOwnProperty(o)&&(i.smtpConfig[o]=f.configData[o])});async function I(){return d.value.smtpConfig.$touch(),d.value.smtpConfig.$invalid||b("submit-data",i.smtpConfig),!1}function c(){d.value.smtpConfig.mail_driver.$touch(),b("on-change-driver",i.smtpConfig.mail_driver)}return(o,n)=>{const h=p("BaseMultiselect"),$=p("BaseInputGroup"),y=p("BaseInput"),D=p("BaseIcon"),U=p("BaseInputGrid"),C=p("BaseButton");return M(),O("form",{onSubmit:z(I,["prevent"])},[l(U,null,{default:m(()=>[l($,{label:o.$t("settings.mail.driver"),"content-loading":t.isFetchingInitialData,error:e(d).smtpConfig.mail_driver.$error&&e(d).smtpConfig.mail_driver.$errors[0].$message,required:""},{default:m(()=>[l(h,{modelValue:e(i).smtpConfig.mail_driver,"onUpdate:modelValue":[n[0]||(n[0]=s=>e(i).smtpConfig.mail_driver=s),c],"content-loading":t.isFetchingInitialData,options:t.mailDrivers,"can-deselect":!1,invalid:e(d).smtpConfig.mail_driver.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.host"),"content-loading":t.isFetchingInitialData,error:e(d).smtpConfig.mail_host.$error&&e(d).smtpConfig.mail_host.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).smtpConfig.mail_host,"onUpdate:modelValue":n[1]||(n[1]=s=>e(i).smtpConfig.mail_host=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"mail_host",invalid:e(d).smtpConfig.mail_host.$error,onInput:n[2]||(n[2]=s=>e(d).smtpConfig.mail_host.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{"content-loading":t.isFetchingInitialData,label:o.$t("settings.mail.username")},{default:m(()=>[l(y,{modelValue:e(i).smtpConfig.mail_username,"onUpdate:modelValue":n[3]||(n[3]=s=>e(i).smtpConfig.mail_username=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"db_name"},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading","label"]),l($,{"content-loading":t.isFetchingInitialData,label:o.$t("settings.mail.password")},{default:m(()=>[l(y,{modelValue:e(i).smtpConfig.mail_password,"onUpdate:modelValue":n[6]||(n[6]=s=>e(i).smtpConfig.mail_password=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:e(q),name:"password"},{right:m(()=>[e(r)?(M(),w(D,{key:0,class:"mr-1 text-gray-500 cursor-pointer",name:"EyeOffIcon",onClick:n[4]||(n[4]=s=>E(r)?r.value=!e(r):r=!e(r))})):(M(),w(D,{key:1,class:"mr-1 text-gray-500 cursor-pointer",name:"EyeIcon",onClick:n[5]||(n[5]=s=>E(r)?r.value=!e(r):r=!e(r))}))]),_:1},8,["modelValue","content-loading","type"])]),_:1},8,["content-loading","label"]),l($,{label:o.$t("settings.mail.port"),"content-loading":t.isFetchingInitialData,error:e(d).smtpConfig.mail_port.$error&&e(d).smtpConfig.mail_port.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).smtpConfig.mail_port,"onUpdate:modelValue":n[7]||(n[7]=s=>e(i).smtpConfig.mail_port=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"mail_port",invalid:e(d).smtpConfig.mail_port.$error,onInput:n[8]||(n[8]=s=>e(d).smtpConfig.mail_port.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.encryption"),"content-loading":t.isFetchingInitialData,error:e(d).smtpConfig.mail_encryption.$error&&e(d).smtpConfig.mail_encryption.$errors[0].$message,required:""},{default:m(()=>[l(h,{modelValue:e(i).smtpConfig.mail_encryption,"onUpdate:modelValue":n[9]||(n[9]=s=>e(i).smtpConfig.mail_encryption=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,options:e(g),searchable:!0,"show-labels":!1,placeholder:"Select option",invalid:e(d).smtpConfig.mail_encryption.$error,onInput:n[10]||(n[10]=s=>e(d).smtpConfig.mail_encryption.$touch())},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.from_mail"),"content-loading":t.isFetchingInitialData,error:e(d).smtpConfig.from_mail.$error&&e(d).smtpConfig.from_mail.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).smtpConfig.from_mail,"onUpdate:modelValue":n[11]||(n[11]=s=>e(i).smtpConfig.from_mail=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"from_mail",invalid:e(d).smtpConfig.from_mail.$error,onInput:n[12]||(n[12]=s=>e(d).smtpConfig.from_mail.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.from_name"),"content-loading":t.isFetchingInitialData,error:e(d).smtpConfig.from_name.$error&&e(d).smtpConfig.from_name.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).smtpConfig.from_name,"onUpdate:modelValue":n[13]||(n[13]=s=>e(i).smtpConfig.from_name=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"from_name",invalid:e(d).smtpConfig.from_name.$error,onInput:n[14]||(n[14]=s=>e(d).smtpConfig.from_name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"])]),_:1}),F("div",le,[l(C,{disabled:t.isSaving,"content-loading":t.isFetchingInitialData,loading:t.isSaving,type:"submit",variant:"primary"},{left:m(s=>[t.isSaving?T("",!0):(M(),w(D,{key:0,name:"SaveIcon",class:A(s.class)},null,8,["class"]))]),default:m(()=>[S(" "+k(o.$t("general.save")),1)]),_:1},8,["disabled","content-loading","loading"]),R(o.$slots,"default")])],40,oe)}}},re=["onSubmit"],se={class:"flex my-10"},me={props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1},mailDrivers:{type:Array,require:!0,default:Array}},emits:["submit-data","on-change-driver"],setup(t,{emit:b}){const f=t,i=P(),{t:u}=j();let r=G(!1);const g=V(()=>r.value?"text":"password"),q=V(()=>({mailgunConfig:{mail_driver:{required:v.withMessage(u("validation.required"),_)},mail_mailgun_domain:{required:v.withMessage(u("validation.required"),_)},mail_mailgun_endpoint:{required:v.withMessage(u("validation.required"),_)},mail_mailgun_secret:{required:v.withMessage(u("validation.required"),_)},from_mail:{required:v.withMessage(u("validation.required"),_),email:N},from_name:{required:v.withMessage(u("validation.required"),_)}}})),a=x(q,V(()=>i));J(()=>{for(const c in i.mailgunConfig)f.configData.hasOwnProperty(c)&&(i.mailgunConfig[c]=f.configData[c])});async function d(){return a.value.mailgunConfig.$touch(),a.value.mailgunConfig.$invalid||b("submit-data",i.mailgunConfig),!1}function I(){a.value.mailgunConfig.mail_driver.$touch(),b("on-change-driver",i.mailgunConfig.mail_driver)}return(c,o)=>{const n=p("BaseMultiselect"),h=p("BaseInputGroup"),$=p("BaseInput"),y=p("BaseIcon"),D=p("BaseInputGrid"),U=p("BaseButton");return M(),O("form",{onSubmit:z(d,["prevent"])},[l(D,null,{default:m(()=>[l(h,{label:c.$t("settings.mail.driver"),"content-loading":t.isFetchingInitialData,error:e(a).mailgunConfig.mail_driver.$error&&e(a).mailgunConfig.mail_driver.$errors[0].$message,required:""},{default:m(()=>[l(n,{modelValue:e(i).mailgunConfig.mail_driver,"onUpdate:modelValue":[o[0]||(o[0]=C=>e(i).mailgunConfig.mail_driver=C),I],"content-loading":t.isFetchingInitialData,options:t.mailDrivers,"can-deselect":!1,invalid:e(a).mailgunConfig.mail_driver.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),l(h,{label:c.$t("settings.mail.mailgun_domain"),"content-loading":t.isFetchingInitialData,error:e(a).mailgunConfig.mail_mailgun_domain.$error&&e(a).mailgunConfig.mail_mailgun_domain.$errors[0].$message,required:""},{default:m(()=>[l($,{modelValue:e(i).mailgunConfig.mail_mailgun_domain,"onUpdate:modelValue":o[1]||(o[1]=C=>e(i).mailgunConfig.mail_mailgun_domain=C),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"mailgun_domain",invalid:e(a).mailgunConfig.mail_mailgun_domain.$error,onInput:o[2]||(o[2]=C=>e(a).mailgunConfig.mail_mailgun_domain.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l(h,{label:c.$t("settings.mail.mailgun_secret"),"content-loading":t.isFetchingInitialData,error:e(a).mailgunConfig.mail_mailgun_secret.$error&&e(a).mailgunConfig.mail_mailgun_secret.$errors[0].$message,required:""},{default:m(()=>[l($,{modelValue:e(i).mailgunConfig.mail_mailgun_secret,"onUpdate:modelValue":o[5]||(o[5]=C=>e(i).mailgunConfig.mail_mailgun_secret=C),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:e(g),name:"mailgun_secret",autocomplete:"off",invalid:e(a).mailgunConfig.mail_mailgun_secret.$error,onInput:o[6]||(o[6]=C=>e(a).mailgunConfig.mail_mailgun_secret.$touch())},{right:m(()=>[e(r)?(M(),w(y,{key:0,class:"mr-1 text-gray-500 cursor-pointer",name:"EyeOffIcon",onClick:o[3]||(o[3]=C=>E(r)?r.value=!e(r):r=!e(r))})):(M(),w(y,{key:1,class:"mr-1 text-gray-500 cursor-pointer",name:"EyeIcon",onClick:o[4]||(o[4]=C=>E(r)?r.value=!e(r):r=!e(r))}))]),_:1},8,["modelValue","content-loading","type","invalid"])]),_:1},8,["label","content-loading","error"]),l(h,{label:c.$t("settings.mail.mailgun_endpoint"),"content-loading":t.isFetchingInitialData,error:e(a).mailgunConfig.mail_mailgun_endpoint.$error&&e(a).mailgunConfig.mail_mailgun_endpoint.$errors[0].$message,required:""},{default:m(()=>[l($,{modelValue:e(i).mailgunConfig.mail_mailgun_endpoint,"onUpdate:modelValue":o[7]||(o[7]=C=>e(i).mailgunConfig.mail_mailgun_endpoint=C),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"mailgun_endpoint",invalid:e(a).mailgunConfig.mail_mailgun_endpoint.$error,onInput:o[8]||(o[8]=C=>e(a).mailgunConfig.mail_mailgun_endpoint.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l(h,{label:c.$t("settings.mail.from_mail"),"content-loading":t.isFetchingInitialData,error:e(a).mailgunConfig.from_mail.$error&&e(a).mailgunConfig.from_mail.$errors[0].$message,required:""},{default:m(()=>[l($,{modelValue:e(i).mailgunConfig.from_mail,"onUpdate:modelValue":o[9]||(o[9]=C=>e(i).mailgunConfig.from_mail=C),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"from_mail",invalid:e(a).mailgunConfig.from_mail.$error,onInput:o[10]||(o[10]=C=>e(a).mailgunConfig.from_mail.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l(h,{label:c.$t("settings.mail.from_name"),"content-loading":t.isFetchingInitialData,error:e(a).mailgunConfig.from_name.$error&&e(a).mailgunConfig.from_name.$errors[0].$message,required:""},{default:m(()=>[l($,{modelValue:e(i).mailgunConfig.from_name,"onUpdate:modelValue":o[11]||(o[11]=C=>e(i).mailgunConfig.from_name=C),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"from_name",invalid:e(a).mailgunConfig.from_name.$error,onInput:o[12]||(o[12]=C=>e(a).mailgunConfig.from_name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"])]),_:1}),F("div",se,[l(U,{disabled:t.isSaving,"content-loading":t.isFetchingInitialData,loading:t.isSaving,variant:"primary",type:"submit"},{left:m(C=>[t.isSaving?T("",!0):(M(),w(y,{key:0,name:"SaveIcon",class:A(C.class)},null,8,["class"]))]),default:m(()=>[S(" "+k(c.$t("general.save")),1)]),_:1},8,["disabled","content-loading","loading"]),R(c.$slots,"default")])],40,re)}}},de=["onSubmit"],ue={class:"flex my-10"},ge={props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1},mailDrivers:{type:Array,require:!0,default:Array}},emits:["submit-data","on-change-driver"],setup(t,{emit:b}){const f=t,i=P(),{t:u}=j();let r=G(!1);const g=H(["tls","ssl","starttls"]),q=V(()=>({sesConfig:{mail_driver:{required:v.withMessage(u("validation.required"),_)},mail_host:{required:v.withMessage(u("validation.required"),_)},mail_port:{required:v.withMessage(u("validation.required"),_),numeric:K},mail_ses_key:{required:v.withMessage(u("validation.required"),_)},mail_ses_secret:{required:v.withMessage(u("validation.required"),_)},mail_encryption:{required:v.withMessage(u("validation.required"),_)},from_mail:{required:v.withMessage(u("validation.required"),_),email:v.withMessage(u("validation.email_incorrect"),N)},from_name:{required:v.withMessage(u("validation.required"),_)}}})),a=x(q,V(()=>i)),d=V(()=>r.value?"text":"password");J(()=>{for(const o in i.sesConfig)f.configData.hasOwnProperty(o)&&(i.sesConfig[o]=f.configData[o])});async function I(){return a.value.sesConfig.$touch(),a.value.sesConfig.$invalid||b("submit-data",i.sesConfig),!1}function c(){a.value.sesConfig.mail_driver.$touch(),b("on-change-driver",i.sesConfig.mail_driver)}return(o,n)=>{const h=p("BaseMultiselect"),$=p("BaseInputGroup"),y=p("BaseInput"),D=p("BaseIcon"),U=p("BaseInputGrid"),C=p("BaseButton");return M(),O("form",{onSubmit:z(I,["prevent"])},[l(U,null,{default:m(()=>[l($,{label:o.$t("settings.mail.driver"),"content-loading":t.isFetchingInitialData,error:e(a).sesConfig.mail_driver.$error&&e(a).sesConfig.mail_driver.$errors[0].$message,required:""},{default:m(()=>[l(h,{modelValue:e(i).sesConfig.mail_driver,"onUpdate:modelValue":[n[0]||(n[0]=s=>e(i).sesConfig.mail_driver=s),c],"content-loading":t.isFetchingInitialData,options:t.mailDrivers,"can-deselect":!1,invalid:e(a).sesConfig.mail_driver.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.host"),"content-loading":t.isFetchingInitialData,error:e(a).sesConfig.mail_host.$error&&e(a).sesConfig.mail_host.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).sesConfig.mail_host,"onUpdate:modelValue":n[1]||(n[1]=s=>e(i).sesConfig.mail_host=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"mail_host",invalid:e(a).sesConfig.mail_host.$error,onInput:n[2]||(n[2]=s=>e(a).sesConfig.mail_host.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.port"),"content-loading":t.isFetchingInitialData,error:e(a).sesConfig.mail_port.$error&&e(a).sesConfig.mail_port.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).sesConfig.mail_port,"onUpdate:modelValue":n[3]||(n[3]=s=>e(i).sesConfig.mail_port=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"mail_port",invalid:e(a).sesConfig.mail_port.$error,onInput:n[4]||(n[4]=s=>e(a).sesConfig.mail_port.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.encryption"),"content-loading":t.isFetchingInitialData,error:e(a).sesConfig.mail_encryption.$error&&e(a).sesConfig.mail_encryption.$errors[0].$message,required:""},{default:m(()=>[l(h,{modelValue:e(i).sesConfig.mail_encryption,"onUpdate:modelValue":n[5]||(n[5]=s=>e(i).sesConfig.mail_encryption=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,options:e(g),invalid:e(a).sesConfig.mail_encryption.$error,placeholder:"Select option",onInput:n[6]||(n[6]=s=>e(a).sesConfig.mail_encryption.$touch())},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.from_mail"),"content-loading":t.isFetchingInitialData,error:e(a).sesConfig.from_mail.$error&&e(a).sesConfig.from_mail.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).sesConfig.from_mail,"onUpdate:modelValue":n[7]||(n[7]=s=>e(i).sesConfig.from_mail=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"from_mail",invalid:e(a).sesConfig.from_mail.$error,onInput:n[8]||(n[8]=s=>e(a).sesConfig.from_mail.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.from_name"),"content-loading":t.isFetchingInitialData,error:e(a).sesConfig.from_name.$error&&e(a).sesConfig.from_name.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).sesConfig.from_name,"onUpdate:modelValue":n[9]||(n[9]=s=>e(i).sesConfig.from_name=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"name",invalid:e(a).sesConfig.from_name.$error,onInput:n[10]||(n[10]=s=>e(a).sesConfig.from_name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.ses_key"),"content-loading":t.isFetchingInitialData,error:e(a).sesConfig.mail_ses_key.$error&&e(a).sesConfig.mail_ses_key.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).sesConfig.mail_ses_key,"onUpdate:modelValue":n[11]||(n[11]=s=>e(i).sesConfig.mail_ses_key=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"mail_ses_key",invalid:e(a).sesConfig.mail_ses_key.$error,onInput:n[12]||(n[12]=s=>e(a).sesConfig.mail_ses_key.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l($,{label:o.$t("settings.mail.ses_secret"),"content-loading":t.isFetchingInitialData,error:e(a).sesConfig.mail_ses_secret.$error&&e(a).mail_ses_secret.$errors[0].$message,required:""},{default:m(()=>[l(y,{modelValue:e(i).sesConfig.mail_ses_secret,"onUpdate:modelValue":n[15]||(n[15]=s=>e(i).sesConfig.mail_ses_secret=s),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:e(d),name:"mail_ses_secret",autocomplete:"off",invalid:e(a).sesConfig.mail_ses_secret.$error,onInput:n[16]||(n[16]=s=>e(a).sesConfig.mail_ses_secret.$touch())},{right:m(()=>[e(r)?(M(),w(D,{key:0,class:"mr-1 text-gray-500 cursor-pointer",name:"EyeOffIcon",onClick:n[13]||(n[13]=s=>E(r)?r.value=!e(r):r=!e(r))})):(M(),w(D,{key:1,class:"mr-1 text-gray-500 cursor-pointer",name:"EyeIcon",onClick:n[14]||(n[14]=s=>E(r)?r.value=!e(r):r=!e(r))}))]),_:1},8,["modelValue","content-loading","type","invalid"])]),_:1},8,["label","content-loading","error"])]),_:1}),F("div",ue,[l(C,{disabled:t.isSaving,"content-loading":t.isFetchingInitialData,loading:t.isSaving,variant:"primary",type:"submit"},{left:m(s=>[t.isSaving?T("",!0):(M(),w(D,{key:0,name:"SaveIcon",class:A(s.class)},null,8,["class"]))]),default:m(()=>[S(" "+k(o.$t("general.save")),1)]),_:1},8,["disabled","content-loading","loading"]),R(o.$slots,"default")])],40,de)}}},fe=["onSubmit"],ce={class:"flex mt-8"},ee={props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1},mailDrivers:{type:Array,require:!0,default:Array}},emits:["submit-data","on-change-driver"],setup(t,{emit:b}){const f=t,i=P(),{t:u}=j(),r=V(()=>({basicMailConfig:{mail_driver:{required:v.withMessage(u("validation.required"),_)},from_mail:{required:v.withMessage(u("validation.required"),_),email:v.withMessage(u("validation.email_incorrect"),N)},from_name:{required:v.withMessage(u("validation.required"),_)}}})),g=x(r,V(()=>i));J(()=>{for(const d in i.basicMailConfig)f.configData.hasOwnProperty(d)&&i.$patch(I=>{I.basicMailConfig[d]=f.configData[d]})});async function q(){return g.value.basicMailConfig.$touch(),g.value.basicMailConfig.$invalid||b("submit-data",i.basicMailConfig),!1}function a(){g.value.basicMailConfig.mail_driver.$touch(),b("on-change-driver",i.basicMailConfig.mail_driver)}return(d,I)=>{const c=p("BaseMultiselect"),o=p("BaseInputGroup"),n=p("BaseInput"),h=p("BaseInputGrid"),$=p("BaseIcon"),y=p("BaseButton");return M(),O("form",{onSubmit:z(q,["prevent"])},[l(h,null,{default:m(()=>[l(o,{label:d.$t("settings.mail.driver"),"content-loading":t.isFetchingInitialData,error:e(g).basicMailConfig.mail_driver.$error&&e(g).basicMailConfig.mail_driver.$errors[0].$message,required:""},{default:m(()=>[l(c,{modelValue:e(i).basicMailConfig.mail_driver,"onUpdate:modelValue":[I[0]||(I[0]=D=>e(i).basicMailConfig.mail_driver=D),a],"content-loading":t.isFetchingInitialData,options:t.mailDrivers,"can-deselect":!1,invalid:e(g).basicMailConfig.mail_driver.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),l(o,{label:d.$t("settings.mail.from_mail"),"content-loading":t.isFetchingInitialData,error:e(g).basicMailConfig.from_mail.$error&&e(g).basicMailConfig.from_mail.$errors[0].$message,required:""},{default:m(()=>[l(n,{modelValue:e(i).basicMailConfig.from_mail,"onUpdate:modelValue":I[1]||(I[1]=D=>e(i).basicMailConfig.from_mail=D),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"from_mail",invalid:e(g).basicMailConfig.from_mail.$error,onInput:I[2]||(I[2]=D=>e(g).basicMailConfig.from_mail.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),l(o,{label:d.$t("settings.mail.from_name"),"content-loading":t.isFetchingInitialData,error:e(g).basicMailConfig.from_name.$error&&e(g).basicMailConfig.from_name.$errors[0].$message,required:""},{default:m(()=>[l(n,{modelValue:e(i).basicMailConfig.from_name,"onUpdate:modelValue":I[3]||(I[3]=D=>e(i).basicMailConfig.from_name=D),modelModifiers:{trim:!0},"content-loading":t.isFetchingInitialData,type:"text",name:"name",invalid:e(g).basicMailConfig.from_name.$error,onInput:I[4]||(I[4]=D=>e(g).basicMailConfig.from_name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"])]),_:1}),F("div",ce,[l(y,{"content-loading":t.isFetchingInitialData,disabled:t.isSaving,loading:t.isSaving,variant:"primary",type:"submit"},{left:m(D=>[t.isSaving?T("",!0):(M(),w($,{key:0,class:A(D.class),name:"SaveIcon"},null,8,["class"]))]),default:m(()=>[S(" "+k(d.$t("general.save")),1)]),_:1},8,["content-loading","disabled","loading"]),R(d.$slots,"default")])],40,fe)}}},ve={class:"flex justify-between w-full"},pe=["onSubmit"],$e={class:"p-4 md:p-8"},Ce={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},_e={setup(t){let b=G(!1),f=H({to:"",subject:"",message:""});const i=Y(),u=P(),{t:r}=j(),g=V(()=>i.active&&i.componentName==="MailTestModal"),q={formData:{to:{required:v.withMessage(r("validation.required"),_),email:v.withMessage(r("validation.email_incorrect"),N)},subject:{required:v.withMessage(r("validation.required"),_),maxLength:v.withMessage(r("validation.subject_maxlength"),Q(100))},message:{required:v.withMessage(r("validation.required"),_),maxLength:v.withMessage(r("validation.message_maxlength"),Q(255))}}},a=x(q,{formData:f});function d(){f.id="",f.to="",f.subject="",f.message="",a.value.$reset()}async function I(){if(a.value.formData.$touch(),a.value.$invalid)return!0;b.value=!0,(await u.sendTestMail(f)).data&&(c(),b.value=!1)}function c(){i.closeModal(),setTimeout(()=>{i.resetModalData(),d()},300)}return(o,n)=>{const h=p("BaseIcon"),$=p("BaseInput"),y=p("BaseInputGroup"),D=p("BaseTextarea"),U=p("BaseInputGrid"),C=p("BaseButton"),s=p("BaseModal");return M(),w(s,{show:e(g),onClose:c},{header:m(()=>[F("div",ve,[S(k(e(i).title)+" ",1),l(h,{name:"XIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:c})])]),default:m(()=>[F("form",{action:"",onSubmit:z(I,["prevent"])},[F("div",$e,[l(U,{layout:"one-column"},{default:m(()=>[l(y,{label:o.$t("general.to"),error:e(a).formData.to.$error&&e(a).formData.to.$errors[0].$message,variant:"horizontal",required:""},{default:m(()=>[l($,{ref:(B,ie)=>{ie.to=B},modelValue:e(f).to,"onUpdate:modelValue":n[0]||(n[0]=B=>e(f).to=B),type:"text",invalid:e(a).formData.to.$error,onInput:n[1]||(n[1]=B=>e(a).formData.to.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),l(y,{label:o.$t("general.subject"),error:e(a).formData.subject.$error&&e(a).formData.subject.$errors[0].$message,variant:"horizontal",required:""},{default:m(()=>[l($,{modelValue:e(f).subject,"onUpdate:modelValue":n[2]||(n[2]=B=>e(f).subject=B),type:"text",invalid:e(a).formData.subject.$error,onInput:n[3]||(n[3]=B=>e(a).formData.subject.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),l(y,{label:o.$t("general.message"),error:e(a).formData.message.$error&&e(a).formData.message.$errors[0].$message,variant:"horizontal",required:""},{default:m(()=>[l(D,{modelValue:e(f).message,"onUpdate:modelValue":n[4]||(n[4]=B=>e(f).message=B),rows:"4",cols:"50",invalid:e(a).formData.message.$error,onInput:n[5]||(n[5]=B=>e(a).formData.message.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})]),F("div",Ce,[l(C,{variant:"primary-outline",type:"button",class:"mr-3",onClick:n[6]||(n[6]=B=>c())},{default:m(()=>[S(k(o.$t("general.cancel")),1)]),_:1}),l(C,{loading:e(b),variant:"primary",type:"submit"},{left:m(B=>[e(b)?T("",!0):(M(),w(h,{key:0,name:"PaperAirplaneIcon",class:A(B.class)},null,8,["class"]))]),default:m(()=>[S(" "+k(o.$t("general.send")),1)]),_:1},8,["loading"])])],40,pe)]),_:1},8,["show"])}}},ye={key:0,class:"mt-14"},De={setup(t){let b=G(!1),f=G(!1);const i=P(),u=Y(),{t:r}=j();q();function g(c){i.mail_driver=c,i.mailConfigData.mail_driver=c}async function q(){f.value=!0,Promise.all([await i.fetchMailDrivers(),await i.fetchMailConfig()]).then(([c])=>{f.value=!1})}const a=V(()=>i.mail_driver=="smtp"?Z:i.mail_driver=="mailgun"?me:i.mail_driver=="sendmail"?ee:i.mail_driver=="ses"?ge:i.mail_driver=="mail"?ee:Z);async function d(c){try{return b.value=!0,await i.updateMailConfig(c),b.value=!1,!0}catch(o){console.error(o)}}function I(){u.openModal({title:r("general.test_mail_conf"),componentName:"MailTestModal",size:"sm"})}return(c,o)=>{const n=p("BaseButton"),h=p("BaseSettingCard");return M(),O(te,null,[l(_e),l(h,{title:c.$t("settings.mail.mail_config"),description:c.$t("settings.mail.mail_config_desc")},{default:m(()=>[e(i)&&e(i).mailConfigData?(M(),O("div",ye,[(M(),w(ae(e(a)),{"config-data":e(i).mailConfigData,"is-saving":e(b),"mail-drivers":e(i).mail_drivers,"is-fetching-initial-data":e(f),onOnChangeDriver:o[0]||(o[0]=$=>g($)),onSubmitData:d},{default:m(()=>[l(n,{variant:"primary-outline",type:"button",class:"ml-2","content-loading":e(f),onClick:I},{default:m(()=>[S(k(c.$t("general.test_mail_conf")),1)]),_:1},8,["content-loading"])]),_:1},8,["config-data","is-saving","mail-drivers","is-fetching-initial-data"]))])):T("",!0)]),_:1},8,["title","description"])],64)}}};export{De as default};
